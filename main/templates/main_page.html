{% extends 'base.html' %}

{% block content %}
<main>
    <div class="container">
        <div class="row justify-content-center">
            {% for p in product %}
            <div class="card">
                <a href="{% url 'product_detail' p.product_id %}">
                    <img src="{{ p.image.url }}" alt="{{ p.product_name }}">
                </a>
                <div class="card-body">
                    <h3>{{ p.product_name }}</h3>
                    <p>{{ p.product_bio }}</p>
                    <p>Цена за 100гр: <span id="product-price" data-price="{{ p.price }}">{{ product.price }}</span>р</p>
                     <form method="POST" action="{% url 'add_to_cart' p.product_id %}">
                        {% csrf_token %}
                        <div style="display: flex; flex-direction: column;">
                            <input type="number" name="quantity" id="quantity" value="1" min="1" onchange="updatePrice()">
                            <button type="submit" style="margin-top: 10px;">Добавить в корзину</button>
                        </div>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</main>

<script>
function updatePrice() {
    var quantity = document.getElementById('quantity').value;
    var pricePerKg = document.getElementById('product-price').getAttribute('data-price');
    var totalPrice = quantity * parseFloat(pricePerKg);
    document.getElementById('product-price').textContent = totalPrice.toFixed(2); // Округляем до 2 знаков после запятой
    document.getElementById('product-price').setAttribute('data-price', totalPrice.toFixed(2));
}
</script>


{% endblock %}
